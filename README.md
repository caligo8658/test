**Сценарий для развертывания nginx + apache2 + php-fpm и т.д.**

**Катался на:**
vagrant 2.0.1
ansible 2.4.0.0

**Комментарии:** 
 - Я так понял, что я создавал скорей среду разработки, а не продакшн среду, поэтому постарался обойтись минимумом переменных
 - Создание алиасов для local интерфейсов виртуалбокса показалось неинтересным, бекенды запускаются на локалхосте, на разных портах, порты генерятся динамически
 - Колличество vhost может быть любым, каждый работает со свойим fpm на локальном сокете
 - Каждому vhost создается своя бд *joomla_{{ client_name }}* с логином и паролем {{ client_name }}/{{ client_name }}. Понимаю что это не правильно, для прода нужен как минимум vault
 - Чтобы обсеспечить доступ из локали, использовал плагин vagrant hostmanager
 
**О сценарии:**
 Сценарий **условно** разбит на 5 ролей:
 
 - services-installation - инсталяция ПО
 - services-cofiguration - настройка ПО 
 - vhost-configuration - конфигурация и настройка веб-серверов
 - services-restart - вынес рестарты всего в отдельную роль, c хендлерами не получится из-за того как я ищу фри-порты :)
 - joomla-installation - создает БД и инсталит жумлу


**Настройка(всё в Vagrantfile):**

Задаем имена клиентов:

    ansible.extra_vars = {                                                                                                                                                                                                                     
        client: '["test1", "test2"]'                                                                                                                                                                                                           
    }

Задаем имена хостов:

	node.hostmanager.aliases = %w(test1.local test2.local)

*Следует иметь ввиду, что для того чтоб работал хостменеджер надо подправить судо*


Впринципе, могу сделать чтобы всё было точно по ТЗ, тогда скажите, как быть с этими **IP**, делать их алиасами?(тогда сценарий почти не изменится).
Еще одна непонятность, после инсталляции жумлы, такое ощущения что она генерит статические страницы, поэтому, после инсталляции работает неправильно, могу справитсься и с этим.
